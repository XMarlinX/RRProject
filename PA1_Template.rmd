#Reproducible Research
#Peer Project 1
#Marlin Thomas

R setup for knitr
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```  
Load libraries. 
```{r}
library(readr)
library(ggplot2)
library(dplyr)
library(lubridate)
```  

#1. Load csv file into R. Examine the file.
```{r}
ActivityData <- read.csv("~/activity.csv")
str(ActivityData)
names(ActivityData)
dim(ActivityData)
```  
#2.Histogram of the total number of steps taken each day.
First, calculate the number of steps per day.
```{r}
StepsPerDay <- ActivityData %>%
  filter(!is.na(steps)) %>%
  group_by(date) %>%
  summarize(StepsPerDay = sum(steps)) %>%
  print
head(StepsPerDay)
```

```{r}

hist(StepsPerDay$StepsPerDay, xlab = "Steps Taken Per Day", main  = "Steps Per Day")
```

#3. Calculate mean and median for steps per day.
```{r}
MeanStepsPerDay <- mean(StepsPerDay$StepsPerDay, na.rm = TRUE)
MedianStepsPerDay <- median(StepsPerDay$StepsPerDay, na.rm = TRUE)
cat ("Mean Steps Per Day: ", MeanStepsPerDay," ")
cat("Median Steps Per Day:", MedianStepsPerDay)
```
#4. Create a time series plot of the average number of steps taken

Calculae average number of steps per five-minute interval.
```{r}
AverageStepsPerInterval <- tapply(ActivityData$steps, ActivityData$interval, mean, na.rm = TRUE)
head(AverageStepsPerInterval)
```
Generate time-series graph of the above.
```{r}
plot (AverageStepsPerInterval, xlab = "Interval", ylab = "Average Steps", main = "Average Steps Per Five-Minute Interval", type = "l")

```
#5. Determine the interval with the highest average number of steps taken.
```{r}
HighestAverage <- max(AverageStepsPerInterval)
HighestAverage
HighestInterval <- AverageStepsPerInterval[HighestAverage]
HighestInterval
```
The highest average is 206, which corresonds to interval 835.

#6. Code a strategy for imputing missing data
Determine how many missing values there are.
```{r}
sum(is.na(ActivityData$steps))
```
To ipute missing values, develop a linear model.
Then replace missing values with values generated by the linear model.
```{r}
Model <- lm (steps ~ interval, data = ActivityData)
Model
summary(Model)
```
This model yields some statistically significant values and will be used to impute values.
```{r}
ImputedDataSet <- ActivityData
head(ImputedDataSet)
for (item in 1:nrow(ImputedDataSet))
  {if( is.na(ImputedDataSet[item,]$steps))
      {
  ImputedDataSet[item,]$steps <- (29.5538 + 0.006649 * ImputedDataSet[item,]$interval)
      }
  
  
  }
head(ImputedDataSet)
```
Create a histogram of the total number of steps per day in the imputed data set.
```{r}  
ImputedStepsPerDay <- ImputedDataSet %>%
  filter(!is.na(steps)) %>%
  group_by(date) %>%
  summarize(ImputedStepsPerDay = sum(steps)) %>%
  print
head(ImputedStepsPerDay)
hist(ImputedDataSet$steps, xlab = "Steps Taken Per Day", main  = "Steps Per Day")
```
Compare the mean of the original and the imputed data sets.
```{r}
MeanOriginal <- mean(StepsPerDay$StepsPerDay)
MeanImputed <- mean(ImputedStepsPerDay$ImputedStepsPerDay) 
MeanOriginal
MeanImputed
```
The difference is not significant.
The imputed data have no impact on esimates for average daily steps taken.
#7. Are there differences in activity patterns between weekdays and weekend.
Create a copy of ActivityData
Add a new variable, day
Change dae from factor to date.
Update day to be either weekend or weekday
```{r}
WeekDayWeekEnd <- ActivityData
WeekDayWeekEnd$date <- as.Date.POSIXct(WeekDayWeekEnd$date, fomat = "%y/%m/%d")
str(WeekDayWeekEnd)
head(WeekDayWeekEnd$date)
for (item in 1 : nrow (WeekDayWeekEnd))
    {
      if ( weekdays(WeekDayWeekEnd$date[item]) == "Saturday" | weekdays(WeekDayWeekEnd$date[item]) == "Sunday")
        
  
          {WeekDayWeekEnd$WeekEnd[item] = "Yes"}
      else
      {WeekDayWeekEnd$WeekEnd[item] = "No"}
    
}
```  

```{r}

for (i in 1:10){
  print (WeekDayWeekEnd$date[i])
  
  
}
Day
dim(Day)

          
```    
#I Cannot figure out why all the days are the same.
Determine the total steps by type of day, weekday or weekend.
```{r}
StepsTypeofDay <- aggregate(WeekDayWeekEnd$steps ~ WeekDayWeekEnd$interval + WeekDayWeekEnd$WeekEnd, WeekDayWeekEnd, mean)
names(StepsTypeofDay)
head(StepsPerDay)
```  
Create a panel plot
```{r}
WeekDay <- subset (WeekDayWeekEnd, WeekEnd = "No")
WeekEnd <- subset (WeekDayWeekEnd, WeekEnd = "Yes")
head(WeekDay)
head(WeekEnd)
```  
